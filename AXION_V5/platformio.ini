; =========================================================
; AXION V4 / V2 — PlatformIO Configuration (propre)
; =========================================================
; Version : 2025-10-19
; Description :
;   - Environnement complet de développement et de release
;   - ESP32 DevKitC ou clone compatible (MHEtLive, Elegoo)
; =========================================================

[platformio]
default_envs = axion_dev

; =========================================================
; ENVIRONNEMENT DE DÉVELOPPEMENT (COMPLET)
; =========================================================
; - Toutes les fonctions de debug actives
; - Logging CSV + BIN
; - Test Mode / Overlays activés
; - Utilisé pour mise au point et validations terrain

[env:axion_dev]
platform      = espressif32
board         = esp32dev
framework     = arduino
monitor_speed = 115200

lib_deps =
  SD

build_flags =
  -DUSE_SD
  -DUSE_BIN_LOG
  -DTEST_MODE
  -DDEBUG_OVERLAYS
  -DV_BATT_ADC_PIN=36
  -DVBATT_DIV_RATIO=2.0

upload_speed  = 921600
monitor_filters = esp32_exception_decoder
build_type    = debug

; =========================================================
; ENVIRONNEMENT DE RELEASE (LÉGER)
; =========================================================
; - Logging CSV seulement (BIN désactivé)
; - Test Mode et Overlays désactivés
; - Flash < 90%
; - Pour tests terrain / production

[env:axion_release]
platform      = espressif32
board         = esp32dev
framework     = arduino
monitor_speed = 115200

lib_deps =
  SD

build_flags =
  -DUSE_SD
  -DNO_BIN_LOG
  -DNO_TEST_MODE
  -DV_BATT_ADC_PIN=36
  -DVBATT_DIV_RATIO=2.0

upload_speed  = 921600
monitor_filters = esp32_exception_decoder
build_type    = release

; =========================================================
; ENVIRONNEMENT RELEASE PROD (< 90% Flash)
; =========================================================
[env:axion_release_prod]
extends = axion_release
platform      = espressif32
board         = esp32dev
framework     = arduino
build_flags =
  -DNO_TRANSITIONS
  -DNO_BOOT_SPLASH
  -DNO_TEST_MODE
  -DPRODUCTION_BUILD
